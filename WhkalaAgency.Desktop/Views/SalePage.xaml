<UserControl x:Class="WhkalaAgency.Desktop.Views.SalesPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             FlowDirection="RightToLeft"
             Background="#F4F7FA">

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<Border Grid.Row="0" Background="White" Padding="20,10" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
			<DockPanel>
				<StackPanel>
					<TextBlock Text="فاتورة مبيعات مجمعة" FontSize="22" FontWeight="Black" Foreground="#2D3748"/>
					<TextBlock Text="إدارة مبيعات التجار وتوزيع مستحقات المزارعين" Foreground="#718096" FontSize="11"/>
				</StackPanel>
				<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
					<TextBlock Text="تاريخ الفاتورة:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="Bold"/>
					<DatePicker x:Name="DtSaleDate" Width="150" Height="32"/>
				</StackPanel>
			</DockPanel>
		</Border>

		<Border Grid.Row="1" Background="White" Margin="15,10" CornerRadius="12" Padding="15" BorderBrush="#E2E8F0" BorderThickness="1">
			<StackPanel>
				<UniformGrid Columns="3" Margin="0,0,0,10">
					<StackPanel Margin="5">
						<TextBlock Text="التاجر (المشتري)" FontWeight="Bold" Margin="0,0,0,5" FontSize="12" Foreground="#4A5568"/>
						<ComboBox x:Name="CboTraders" DisplayMemberPath="Name" SelectedValuePath="Id" Height="35"/>
					</StackPanel>
					<StackPanel Margin="5">
						<TextBlock Text="المزارع (صاحب البضاعة)" FontWeight="Bold" Margin="0,0,0,5" FontSize="12" Foreground="#4A5568"/>
						<ComboBox x:Name="CboFarmers" DisplayMemberPath="Name" SelectedValuePath="Id" Height="35"/>
					</StackPanel>
					<StackPanel Margin="5">
						<TextBlock Text="الصنف المباع" FontWeight="Bold" Margin="0,0,0,5" FontSize="12" Foreground="#4A5568"/>
						<ComboBox x:Name="CboProducts" DisplayMemberPath="Name" SelectedValuePath="Id" Height="35"/>
					</StackPanel>
				</UniformGrid>
				<Grid Margin="0,0,0,15">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="1.2*"/>
						<ColumnDefinition Width="1.2*"/>
						<ColumnDefinition Width="1.2*"/>
						<ColumnDefinition Width="1.5*"/>
						<ColumnDefinition Width="1.2*"/>
					</Grid.ColumnDefinitions>

					<StackPanel Grid.Column="0" Margin="5,0">
						<TextBlock Text="الكمية" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,5" Foreground="#4A5568"/>
						<TextBox x:Name="TxtQuantity" Height="38" VerticalContentAlignment="Center" Padding="5,0" FontSize="14"/>
					</StackPanel>

					<StackPanel Grid.Column="1" Margin="5,0">
						<TextBlock Text="الوزن القائم" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,5" Foreground="#4A5568"/>
						<TextBox x:Name="TxtGrossWeight" Height="38" TextChanged="CalculateWeights" VerticalContentAlignment="Center" Padding="5,0" FontSize="14"/>
					</StackPanel>

					<StackPanel Grid.Column="2" Margin="5,0">
						<TextBlock Text="وزن الفارغ" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,5" Foreground="#4A5568"/>
						<TextBox x:Name="TxtTareWeight" Height="38" TextChanged="CalculateWeights" VerticalContentAlignment="Center" Padding="5,0" FontSize="14"/>
					</StackPanel>

					<StackPanel Grid.Column="3" Margin="5,0">
						<TextBlock Text="صافي الوزن" FontSize="12" FontWeight="Bold" Foreground="#2B6CB0" Margin="0,0,0,5"/>
						<TextBox x:Name="TxtNetWeight" Height="38" IsReadOnly="True" Background="#F0F9FF" FontWeight="Bold" VerticalContentAlignment="Center" Padding="5,0" FontSize="15" BorderBrush="#BEE3F8"/>
					</StackPanel>

					<StackPanel Grid.Column="4" Margin="5,0">
						<TextBlock Text="سعر الوحدة" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,5" Foreground="#4A5568"/>
						<TextBox x:Name="TxtPrice" Height="38" VerticalContentAlignment="Center" Padding="5,0" FontSize="14"/>
					</StackPanel>
				</Grid>

				<Button Content="إضافة الصنف للقائمة +" Click="BtnAddToBasket_Click" Background="#3182CE" Foreground="White" Height="38" FontWeight="Bold"/>

				<DataGrid x:Name="BasketGrid" AutoGenerateColumns="False" Height="110" Margin="0,10" Background="#F8FAFC" IsReadOnly="True" CanUserAddRows="False">
					<DataGrid.Columns>
						<DataGridTextColumn Header="المزارع" Binding="{Binding FarmerName}" Width="1*"/>
						<DataGridTextColumn Header="الصنف" Binding="{Binding ProductName}" Width="1*"/>
						<DataGridTextColumn Header="الصافي" Binding="{Binding NetWeight}" Width="60"/>
						<DataGridTextColumn Header="الإجمالي" Binding="{Binding TotalAmount, StringFormat={}{0:N2}}" Width="80"/>
					</DataGrid.Columns>
				</DataGrid>

				<Grid>
					<StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
						<TextBlock Text="الدفع:" VerticalAlignment="Center" FontWeight="Bold" Margin="0,0,10,0"/>
						<ComboBox x:Name="CboPaymentType" Width="100" Height="32" SelectedIndex="0">
							<ComboBoxItem Content="نقدي" Tag="Cash"/>
							<ComboBoxItem Content="آجل" Tag="Credit"/>
						</ComboBox>
					</StackPanel>
					<StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
						<TextBlock Text="الإجمالي:" VerticalAlignment="Center" Margin="0,0,10,0"/>
						<TextBlock x:Name="LblGrandTotal" Text="0.00 ج.م" FontSize="20" FontWeight="Black" Foreground="#2C7A7B" Margin="0,0,15,0"/>
						<Button Content="ترحيل الفاتورة" Click="BtnSaveSale_Click" Width="130" Height="38" Background="#38A169" Foreground="White" FontWeight="Bold"/>
					</StackPanel>
				</Grid>
			</StackPanel>
		</Border>

		<Border Grid.Row="2" Background="White" Margin="15,0,15,15" CornerRadius="12" BorderBrush="#E2E8F0" BorderThickness="1">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto"/>
					<RowDefinition Height="*"/>
				</Grid.RowDefinitions>

				<TextBlock Text="سجل المبيعات الأخير" FontWeight="Bold" Margin="15,10,0,5" Foreground="#4A5568"/>

				<DataGrid x:Name="SalesGrid"
                          Grid.Row="1"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          GridLinesVisibility="Horizontal"
                          AlternatingRowBackground="#F7FAFC"
                          RowHeight="32"
                          BorderThickness="0"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Auto">
					<DataGrid.Columns>
						<DataGridTextColumn Header="التاريخ" Binding="{Binding SaleDate}" Width="90"/>
						<DataGridTextColumn Header="التاجر" Binding="{Binding TraderName}" Width="1*"/>
						<DataGridTextColumn Header="المزارع" Binding="{Binding FarmerName}" Width="1*"/>
						<DataGridTextColumn Header="الصنف" Binding="{Binding ProductName}" Width="1*"/>
						<DataGridTextColumn Header="الصافي" Binding="{Binding NetWeight}" Width="70"/>
						<DataGridTextColumn Header="القيمة" Binding="{Binding TotalAmount, StringFormat={}{0:N2}}" Width="90"/>
					</DataGrid.Columns>
				</DataGrid>
			</Grid>
		</Border>
	</Grid>
</UserControl>