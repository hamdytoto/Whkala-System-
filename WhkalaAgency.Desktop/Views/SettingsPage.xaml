<UserControl x:Class="WhkalaAgency.Desktop.Views.SettingsPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             FlowDirection="RightToLeft"
             Background="#F4F7FA">

	<Grid Margin="20">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<TextBlock Text="إعدادات النظام" FontSize="26" FontWeight="Black" Foreground="#2D3748" Margin="0,0,0,20"/>

		<TabControl Grid.Row="1" Background="Transparent" BorderThickness="0">
			<TabItem Header="الإعدادات العامة">
				<Border Background="White" CornerRadius="12" Padding="20" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
					<StackPanel MaxWidth="400" HorizontalAlignment="Left">
						<TextBlock Text="نسبة عمولة الوكالة (مثال: 0.05 تعني 5%)" FontWeight="Bold" Margin="0,0,0,10"/>
						<TextBox x:Name="TxtCommissionRate" Height="40" VerticalContentAlignment="Center" Margin="0,0,0,20"/>

						<Button x:Name="BtnSaveGeneralSettings" Content="حفظ الإعدادات العامة"
                                Click="BtnSaveGeneralSettings_Click" Background="#3182CE"
                                Foreground="White" Height="45" FontWeight="Bold"/>
					</StackPanel>
				</Border>
			</TabItem>

			<TabItem Header="إدارة المستخدمين">
				<Grid Margin="0,10,0,0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="350"/>
						<ColumnDefinition Width="*"/>
					</Grid.ColumnDefinitions>

					<Border Background="White" CornerRadius="12" Padding="15" BorderBrush="#E2E8F0" BorderThickness="1">
						<StackPanel>
							<TextBlock Text="إضافة مستخدم جديد" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>

							<TextBlock Text="اسم المستخدم"/>
							<TextBox x:Name="TxtUsername" Height="35" Margin="0,5,0,10"/>

							<TextBlock Text="الاسم الكامل"/>
							<TextBox x:Name="TxtFullName" Height="35" Margin="0,5,0,10"/>

							<TextBlock Text="كلمة المرور"/>
							<PasswordBox x:Name="TxtPassword" Height="35" Margin="0,5,0,10"/>

							<TextBlock Text="الصلاحية"/>
							<ComboBox x:Name="CboRole" Height="35" Margin="0,5,0,20">
								<ComboBoxItem Content="مدير نظام (Admin)" IsSelected="True" Tag="Admin"/>
								<ComboBoxItem Content="موظف (Operator)" Tag="Operator"/>
							</ComboBox>

							<Button x:Name="BtnAddUser" Content="إضافة المستخدم" Click="BtnAddUser_Click"
                                    Background="#38A169" Foreground="White" Height="40" FontWeight="Bold"/>
						</StackPanel>
					</Border>

					<Border Grid.Column="1" Background="White" CornerRadius="12" Margin="15,0,0,0" Padding="15" BorderBrush="#E2E8F0" BorderThickness="1">
						<DataGrid x:Name="UsersGrid" AutoGenerateColumns="False" IsReadOnly="True" CanUserAddRows="False">
							<DataGrid.Columns>
								<DataGridTextColumn Header="الاسم الكامل" Binding="{Binding FullName}" Width="*"/>
								<DataGridTextColumn Header="اسم المستخدم" Binding="{Binding Username}" Width="*"/>
								<DataGridTextColumn Header="الصلاحية" Binding="{Binding Role}" Width="100"/>
								<DataGridTemplateColumn Width="80">
									<DataGridTemplateColumn.CellTemplate>
										<DataTemplate>
											<Button Content="حذف" Click="BtnDeleteUser_Click" Background="Transparent" BorderThickness="0" Foreground="#E53E3E" FontWeight="Bold"/>
										</DataTemplate>
									</DataGridTemplateColumn.CellTemplate>
								</DataGridTemplateColumn>
							</DataGrid.Columns>
						</DataGrid>
					</Border>
				</Grid>
			</TabItem>

			<TabItem Header="قاعدة البيانات">
				<Border Background="White" CornerRadius="12" Padding="20" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
					<StackPanel MaxWidth="500" HorizontalAlignment="Left">
						<TextBlock Text="النسخ الاحتياطي" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>
						<TextBlock Text="يوصى بأخذ نسخة احتياطية يومياً لضمان سلامة البيانات." Foreground="#718096" Margin="0,0,0,20"/>

						<Button x:Name="BtnBackup" Content="إنشاء نسخة احتياطية الآن (Backup)"
                                Click="BtnBackup_Click" Background="#805AD5"
                                Foreground="White" Height="45" FontWeight="Bold"/>

						<TextBlock Text="سجل العمليات الأخيرة:" FontWeight="Bold" Margin="0,30,0,10"/>
						<DataGrid x:Name="BackupsGrid" AutoGenerateColumns="False" Height="200">
							<DataGrid.Columns>
								<DataGridTextColumn Header="التاريخ" Binding="{Binding CreatedAt}" Width="150"/>
								<DataGridTextColumn Header="المسار" Binding="{Binding BackupPath}" Width="*"/>
							</DataGrid.Columns>
						</DataGrid>
					</StackPanel>
				</Border>
			</TabItem>
		</TabControl>
	</Grid>
</UserControl>